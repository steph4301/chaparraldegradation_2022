break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- 0
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ nonnative_grass,
type = "bic"
)
abcover_nonnativecover_nngrasscover2 <- abcover_nonnativecover_nngrasscover[order(abcover_nonnativecover_nngrasscover$nonnative_forb , decreasing = TRUE),]
tail <- max(abcover_nonnativecover_nngrasscover2$nonnative_grass, n = 1)
p1 <- ggplot(abcover_nonnativecover_nngrasscover2, aes(x = nonnative_grass, y = nonnative_forb)) +
geom_point()
model <- lm(nonnative_forb ~ nonnative_grass, data = abcover_nonnativecover_nngrasscover2)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ nonnative_grass,
type = "bic"
)
bp <- as.data.frame(my.seg$psi)
bp <- as.list(bp$Est.)
bpcount <- length(bp) + 1
bpcount1 <- length(bp) - 1
modelxbeg <- rep(NaN, times = bpcount)
modelxend <- rep(NaN, times = bpcount)
modelybeg <- rep(NaN, times = bpcount)
modelyend <- rep(NaN, times = bpcount)
intercept <- rep(NaN, times = bpcount)
slope1 <- rep(NaN, times = bpcount)
break1 <- rep(NaN, times = bpcount)
for (i in 1:bpcount) {
break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- 0
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
abcover_nonnativecover_nngrasscover2 <- abcover_nonnativecover_nngrasscover[order(abcover_nonnativecover_nngrasscover$nonnative_forb , decreasing = TRUE),]
tail <- max(abcover_nonnativecover_nngrasscover2$nonnative_grass, n = 1)
p1 <- ggplot(abcover_nonnativecover_nngrasscover2, aes(x = nonnative_grass, y = nonnative_forb)) +
geom_point()
model <- lm(nonnative_forb ~ nonnative_grass, data = abcover_nonnativecover_nngrasscover2)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model
)
bp <- as.data.frame(my.seg$psi)
bp <- as.list(bp$Est.)
bpcount <- length(bp) + 1
bpcount1 <- length(bp) - 1
modelxbeg <- rep(NaN, times = bpcount)
modelxend <- rep(NaN, times = bpcount)
modelybeg <- rep(NaN, times = bpcount)
modelyend <- rep(NaN, times = bpcount)
intercept <- rep(NaN, times = bpcount)
slope1 <- rep(NaN, times = bpcount)
break1 <- rep(NaN, times = bpcount)
for (i in 1:bpcount) {
break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- 0
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
my.seg
summary(my.seg)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
npsi = 2)
summary(my.seg)
abcover_nonnativecover_nngrasscover2 <- abcover_nonnativecover_nngrasscover[order(abcover_nonnativecover_nngrasscover$native_shrub, decreasing = TRUE),]
tail <- max(abcover_nonnativecover_nngrasscover2$nonnative_grass, n = 1)
p1 <- ggplot(abcover_nonnativecover_nngrasscover2, aes(x = nonnative_grass, y = native_shrub)) +
geom_point()
model <- lm(native_shrub ~ nonnative_grass, data = abcover_nonnativecover_nngrasscover2)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ nonnative_grass,
npsi = 1
)
bp <- as.data.frame(my.seg$psi)
bp <- as.list(bp$Est.)
bpcount <- length(bp) + 1
bpcount1 <- length(bp) - 1
modelxbeg <- rep(NaN, times = bpcount)
modelxend <- rep(NaN, times = bpcount)
modelybeg <- rep(NaN, times = bpcount)
modelyend <- rep(NaN, times = bpcount)
intercept <- rep(NaN, times = bpcount)
slope1 <- rep(NaN, times = bpcount)
break1 <- rep(NaN, times = bpcount)
for (i in 1:bpcount) {
break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- 0
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
summary(my.seg)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ nonnative_grass,
npsi = 2
)
summary(my.seg)
abcover_nonnativecover_nngrasscover2 <- abcover_nonnativecover_nngrasscover[order(abcover_nonnativecover_nngrasscover$native_shrub, decreasing = TRUE),]
tail <- max(abcover_nonnativecover_nngrasscover2$native_shrub, n = 1)
p1 <- ggplot(abcover_nonnativecover_nngrasscover2, aes(y = percentcover_nonnative, x = native_shrub)) +
geom_point()
model <- lm(percentcover_nonnative ~ native_shrub, data = abcover_nonnativecover_nngrasscover2)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 1
)
bp <- as.data.frame(my.seg$psi)
bp <- as.list(bp$Est.)
bpcount <- length(bp) + 1
bpcount1 <- length(bp) - 1
modelxbeg <- rep(NaN, times = bpcount)
modelxend <- rep(NaN, times = bpcount)
modelybeg <- rep(NaN, times = bpcount)
modelyend <- rep(NaN, times = bpcount)
intercept <- rep(NaN, times = bpcount)
slope1 <- rep(NaN, times = bpcount)
break1 <- rep(NaN, times = bpcount)
for (i in 1:bpcount) {
break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- 0
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
summary(my.seg)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 2
)
summary(my.seg)
my.seg
abcover_nonnativecover_nngrasscover2 <- abcover_nonnativecover_nngrasscover[order(abcover_nonnativecover_nngrasscover$native_shrub, decreasing = TRUE),]
tail <- max(abcover_nonnativecover_nngrasscover2$native_shrub, n = 1)
p1 <- ggplot(abcover_nonnativecover_nngrasscover2, aes(y = percentcover_nonnative, x = native_shrub)) +
geom_point()
model <- lm(percentcover_nonnative ~ native_shrub, data = abcover_nonnativecover_nngrasscover2)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 2
)
bp <- as.data.frame(my.seg$psi)
bp <- as.list(bp$Est.)
bpcount <- length(bp) + 1
bpcount1 <- length(bp) - 1
modelxbeg <- rep(NaN, times = bpcount)
modelxend <- rep(NaN, times = bpcount)
modelybeg <- rep(NaN, times = bpcount)
modelyend <- rep(NaN, times = bpcount)
intercept <- rep(NaN, times = bpcount)
slope1 <- rep(NaN, times = bpcount)
break1 <- rep(NaN, times = bpcount)
for (i in 1:bpcount) {
break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- 0
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
abcover_nonnativecover_nngrasscover2 <- abcover_nonnativecover_nngrasscover[order(abcover_nonnativecover_nngrasscover$native_shrub, decreasing = TRUE),]
tail <- max(abcover_nonnativecover_nngrasscover2$native_shrub, n = 1)
p1 <- ggplot(abcover_nonnativecover_nngrasscover2, aes(y = nonnative_grass, x = native_shrub)) +
geom_point()
model <- lm(nonnative_grass~ native_shrub, data = abcover_nonnativecover_nngrasscover2)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 2
)
bp <- as.data.frame(my.seg$psi)
bp <- as.list(bp$Est.)
bpcount <- length(bp) + 1
bpcount1 <- length(bp) - 1
modelxbeg <- rep(NaN, times = bpcount)
modelxend <- rep(NaN, times = bpcount)
modelybeg <- rep(NaN, times = bpcount)
modelyend <- rep(NaN, times = bpcount)
intercept <- rep(NaN, times = bpcount)
slope1 <- rep(NaN, times = bpcount)
break1 <- rep(NaN, times = bpcount)
for (i in 1:bpcount) {
break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- 0
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
summary(my.seg)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 1
)
summary(my.seg)
abcover_nativecover_nngrasscover2 <- abcover_nativecover_nngrasscover[order(abcover_nativecover_nngrasscover$native_forb, decreasing = TRUE),]
tail <- max(abcover_nativecover_nngrasscover2$native_forb, n = 1)
p1 <- ggplot(abcover_nativecover_nngrasscover2, aes(y = native_forb, x = native_shrub)) +
geom_point()
model <- lm(native_forb ~ native_shrub, data = abcover_nativecover_nngrasscover2)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 1
)
bp <- as.data.frame(my.seg$psi)
bp <- as.list(bp$Est.)
bpcount <- length(bp) + 1
bpcount1 <- length(bp) - 1
modelxbeg <- rep(NaN, times = bpcount)
modelxend <- rep(NaN, times = bpcount)
modelybeg <- rep(NaN, times = bpcount)
modelyend <- rep(NaN, times = bpcount)
intercept <- rep(NaN, times = bpcount)
slope1 <- rep(NaN, times = bpcount)
break1 <- rep(NaN, times = bpcount)
for (i in 1:bpcount) {
break1[i] <- my.seg$psi[[i+bpcount1]]
if (i == 1) {
slope1[i] <- coef(my.seg)[[2]]
intercept[i] <- coef(my.seg)[[1]]
break1[i] <- min(abcover_nativecover_nngrasscover2$percentcover_native, n = 1)
}
else {
slope1[i] <- slope1[i-1] + coef(my.seg)[[i+1]]
intercept[i] <- (intercept[i-1] + slope1[i-1]*break1[i]) - (slope1[i]*break1[i])
}
}
modelxend <- c(tail(break1, n = length(break1)-1), tail)
for (i in 1:bpcount) {
modelybeg[i] <- slope1[i]*break1[i] + intercept[i]
modelyend[i] <- slope1[i]*modelxend[i] + intercept[i]
}
segment_data = data.frame(
x = break1,
xend = modelxend,
y = modelybeg,
yend = modelyend)
# second row of the psi-matrix
my.lines <- data.frame(psi = my.seg$psi[, 2], label = round(my.seg$psi[, 2], digits = 3))
modelgraph_nnngrass <- p1 +
geom_vline(xintercept = my.lines$psi, linetype = "dashed") +
geom_segment(
data = segment_data,
mapping = aes(x=x, y=y, xend=xend, yend=yend),
inherit.aes = FALSE) +
geom_text(data = my.lines,
mapping = aes(x = psi, y = rep(0.85, length(my.lines$psi)), label = label),
inherit.aes = FALSE,
hjust = 1)
modelgraph_nnngrass
summary(my.seg)
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 2
)
summary(my.seg)
plot(fitted(my.seg))
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model)
plot(fitted(my.seg))
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model,
seg.Z = ~ native_shrub,
npsi = 2
)
plot(fitted(my.seg))
#analyze breakpoints
# have to provide estimates for breakpoints.
# after looking a the data,
my.seg <- segmented(model)
plot(fitted(my.seg))
View(ab_diversity)
View(ab_diversity_2)
View(ab_diversity_2)
