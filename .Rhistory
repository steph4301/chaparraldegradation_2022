se = round((sd(richness)) / sqrt(length(richness)),3))
richness %>%
group_by(sdbk_clust) %>%
summarize(mean = mean(richness),
se = ((sd(richness)) / sqrt(length(richness))))
round
richness %>%
group_by(sdbk_clust) %>%
summarize(mean = mean(richness),
se = round((sd(richness)) / sqrt(length(richness)),3))
richness %>%
group_by(sdbk_clust) %>%
summarize(mean = round(mean(richness), 3),
se = round((sd(richness)) / sqrt(length(richness)),3))
richness %>%
group_by(sdbk_clust) %>%
summarize(mean = round(mean(richness), 1),
se = round((sd(richness)) / sqrt(length(richness)),1))
grassmortality_load <- read_excel("~/Library/CloudStorage/GoogleDrive-sama@ucsb.edu/.shortcut-targets-by-id/0B4t3p3lzjOQWQ3JJNi1MVHUwbVE/NFWF_PIRU_2016-2022/DATA & Protocols/Grass seedling trial - Piru 2018.xlsx")
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx")
grassmortality <- grassmortality_load %>%
mutate(temp = as.integer(temp),
min = as.integer(min),
rep = as.integer(rep),
grass_germ = as.integer(grass_germ))
view(grassmortality)
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx/grassmortality")
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx")
view(grassmortality_load)
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx", sheet = "grassmortality"))
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx", sheet = "grassmortality")
view(grassmortality_load)
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx", sheet = "notes")
view(grassmortality_load)
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx", sheet = "grassmortality")
view(grassmortality_;pa)
view(grassmortality_load)
grassmortality <- grassmortality_load %>%
mutate(temp = as.integer(temp),
min = as.integer(min),
rep = as.integer(rep),
grass_germ = as.integer(grass_germ))
# view data
plot(grass_germ ~ date, grassmortality)
maxgerm <- grassmortality %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ))
summary <- maxgerm %>%
group_by(temp, min) %>%
summarize(mean_germ = mean(max_germ))
ggplot(data = summary,
aes(x = temp, y = 100*(mean_germ/10), color = factor(min))) +
geom_point(size = 3, alpha = 0.8) +
# geom_smooth(method = "lm", se = FALSE, aes(group = min, color = (factor(min)))) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = FALSE,
aes(group = min, color = (factor(min)))) +  # Add polynomial regression line (degree = 2)
ylim(0, 100)+
xlim(0,250) +
labs(x = "Temperature (C)",
y = "Germination (%)",
title = "Average BRDI germination by temperatue and time") +
scale_color_manual(values = c("orange", "forestgreen", "navy") ,name = "Duration (minutes)") +
theme_bw()
view(grassmortality)
maxgerm <- grassmortality %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ))
summary <- maxgerm %>%
group_by(temp, min) %>%
summarize(mean_germ = mean(max_germ))
summary
names(summary)
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp)) +
geom_point(size = 3, alpha = 0.8)
min
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp))) +
geom_point(size = 3, alpha = 0.8)
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp))) +
geom_point(size = 3, alpha = 0.8) +
# geom_smooth(method = "lm", se = FALSE, aes(group = min, color = (factor(min)))) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = FALSE,
aes(group = temp, color = (factor(temp)))) +  # Add polynomial regression line (degree = 2)
ylim(0, 100)+
xlim(0,250) +
labs(x = "Exposure time (minutes)",
y = "Germination (%)",
title = "Average BRDI germination by exposure time and temperature") +
scale_color_manual(values = c("blue", "purple", "darkgreen", "orange", "red", "yellow") ,name = "Temperature (C)") +
theme_bw()
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp))) +
geom_point(size = 3, alpha = 0.8) +
# geom_smooth(method = "lm", se = FALSE, aes(group = min, color = (factor(min)))) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = FALSE,
aes(group = temp, color = (factor(temp)))) +  # Add polynomial regression line (degree = 2)
ylim(0, 100)+
xlim(0,15) +
labs(x = "Exposure time (minutes)",
y = "Germination (%)",
title = "Average BRDI germination by exposure time and temperature") +
scale_color_manual(values = c("blue", "purple", "darkgreen", "orange", "red", "yellow") ,name = "Temperature (C)") +
theme_bw()
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp))) +
geom_point(size = 3, alpha = 0.8) +
# geom_smooth(method = "lm", se = FALSE, aes(group = min, color = (factor(min)))) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = T,
aes(group = temp, color = (factor(temp)))) +  # Add polynomial regression line (degree = 2)
ylim(0, 100)+
xlim(0,15) +
labs(x = "Exposure time (minutes)",
y = "Germination (%)",
title = "Average BRDI germination by exposure time and temperature") +
scale_color_manual(values = c("blue", "purple", "darkgreen", "orange", "red", "yellow") ,name = "Temperature (C)") +
theme_bw()
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp))) +
geom_point(size = 3, alpha = 0.8) +
# geom_smooth(method = "lm", se = FALSE, aes(group = min, color = (factor(min)))) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = TRUE,
aes(group = temp, color = (factor(temp)))) +  # Add polynomial regression line (degree = 2)
ylim(0, 100)+
xlim(0,15) +
labs(x = "Exposure time (minutes)",
y = "Germination (%)",
title = "Average BRDI germination by exposure time and temperature") +
scale_color_manual(values = c("blue", "purple", "darkgreen", "orange", "red", "yellow") ,name = "Temperature (C)") +
theme_bw()
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp))) +
geom_point(size = 3, alpha = 0.8) +
# geom_smooth(method = "lm", se = FALSE, aes(group = min, color = (factor(min)))) +
geom_smooth(method = "lm", se = TRUE,# formula = y ~ poly(x, 2),
aes(group = temp, color = (factor(temp)))) +  # Add polynomial regression line (degree = 2)
ylim(0, 100)+
xlim(0,15) +
labs(x = "Exposure time (minutes)",
y = "Germination (%)",
title = "Average BRDI germination by exposure time and temperature") +
scale_color_manual(values = c("blue", "purple", "darkgreen", "orange", "red", "yellow") ,name = "Temperature (C)") +
theme_bw()
ggplot(data = summary,
aes(x = min, y = 100*(mean_germ/10), color = factor(temp))) +
geom_point(size = 3, alpha = 0.8) +
# geom_smooth(method = "lm", se = FALSE, aes(group = min, color = (factor(min)))) +
geom_smooth(method = "lm", se = TRUE,# formula = y ~ poly(x, 2),
aes(group = temp, color = (factor(temp)))) +  # Add polynomial regression line (degree = 2)
ylim(0, 100)+
xlim(0,15) +
labs(x = "Exposure time (minutes)",
y = "Germination (%)",
title = "Average BRDI germination by exposure time and temperature") +
scale_color_manual(values = c("blue", "purple", "darkgreen", "orange", "red", "black") ,name = "Temperature (C)") +
theme_bw()
maxgerm
summary <- maxgerm %>%
group_by(temp, min) %>%
summarize(n = length(maxgerm),
mean_germ = mean(max_germ)
)
summary
# load data
library(readxl)
grassmortality_load <- read_excel("Grass seedling trial - Piru 2018.xlsx", sheet = "grassmortality")
grassmortality <- grassmortality_load %>%
mutate(temp = as.integer(temp),
min = as.integer(min),
rep = as.integer(rep),
grass_germ = as.integer(grass_germ))
view(grassmortality)
# view data
plot(grass_germ ~ date, grassmortality)
maxgerm <- grassmortality %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ))
summary <- maxgerm %>%
group_by(temp, min) %>%
summarize(n = length(maxgerm),
mean_germ = mean(maxgerm),
sd = sd(maxgerm)
)
grassmortality <- grassmortality_load %>%
mutate(temp = as.character(temp),
min = as.character(min),
rep = as.character(rep),
grass_germ = as.integer(grass_germ))
# view data
plot(grass_germ ~ date, grassmortality)
maxgerm <- grassmortality %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ))
summary <- maxgerm %>%
group_by(temp, min) %>%
summarize(n = length(maxgerm),
mean_germ = mean(maxgerm),
sd = sd(maxgerm)
)
str(maxgerm)
names(maxgerm)
head(maxgerm)
maxgerm <- grassmortality %>%
dplyr::select(temp, min, rep, grass_germ) %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ))
head(maxgerm)
maxgerm <- grassmortality %>%
dplyr::select(temp, min, rep, grass_germ) %>%
group_by(temp, min, rep) %>%
summary(max_germ = max(grass_germ))
head(maxgerm)
maxgerm <- grassmortality %>%
dplyr::select(temp, min, rep, grass_germ) %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ))
view(maxgerm)
maxgerm <- grassmortality %>%
dplyr::select(temp, min, rep, grass_germ) %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ)) %>%
dplyr::select(temp, min, rep, max_germ)
head(maxgerm)
view(maxgerm)
maxgerm <- grassmortality %>%
dplyr::select(temp, min, rep, grass_germ) %>%
group_by(temp, min, rep) %>%
mutate(max_germ = max(grass_germ)) %>%
ungroup() %>%
dplyr::select(temp, min, rep, max_germ)
view(maxgerm)
view(grassmortality)
unique(grassmortality$date)
# view data
plot(grass_germ ~ date, grassmortality)
unique(grassmortality$)unique(grassmortality$temp)
unique(grassmortality$temp)
unique(grassmortality$min)
unique(grassmortality$rep)
6*3*5
library(tidyverse)
grassmortality <- grassmortality_load %>%
mutate(temp = as.character(temp),
min = as.character(min),
rep = as.character(rep),
grass_germ = as.integer(grass_germ)) %>%
mutate(temp.min = paste(temp, min, sep = ".")) %>%
mutate(uniqueID = paste(temp.min, rep, sep = "."))
head(grassmortality)
grassmortality <- grassmortality_load %>%
mutate(temp = as.character(temp),
min = as.character(min),
rep = as.character(rep),
grass_germ = as.integer(grass_germ)) %>%
mutate(temp.min = paste(temp, min, sep = "C.")) %>%
mutate(uniqueID = paste(temp.min, rep, sep = ".rep"))
head(grassmortality)
grassmortality <- grassmortality_load %>%
mutate(date = as.character(date),
temp = as.character(temp),
min = as.character(min),
rep = as.character(rep),
grass_germ = as.integer(grass_germ)) %>%
mutate(temp.min = paste(temp, min, sep = "C.")) %>%
mutate(uniqueID = paste(temp.min, rep, sep = ".rep"))
head(grassmortality)
grassmortality %>%  filter(uniqueID == "20C.1")
grassmortality %>%  filter(temp.min == "20C.1")
a <- grassmortality %>%  filter(temp.min == "20C.1")
view(a)
a <- grassmortality %>%  filter(temp.min == "20C.2")
view(a)
max(a$grass_germ)
max_perrep <- grassmortality %>%
group_by(uniqueID) %>%
mutate(max_germ = max(grass_germ))
view(max_perrep)
source("~/Library/CloudStorage/Dropbox/GRADSCHOOL/Dissertation/R_dissertation/chaparraldegradation_2022/chaparraldegradation_2022/grassmortality_2018.R", echo=TRUE)
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, grass_germ, temp.min, uniqueID)
head(max_perrep)
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, grass_germ, temp.min, uniqueID) %>%
group_by(uniqueID) %>%
mutate(max_germ = max(grass_germ))
view(max_perrep)
max_perrep <- grassmortality %>%
group_by(uniqueID)
view(max_perrep)
max_perrep <- grassmortality %>%
group_by(uniqueID) %>%
summarize(max_germ = max(grass_germ))
view(max_perrep)
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID) %>%
group_by(uniqueID) %>%
summarize(max_germ = max(grass_germ))
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(uniqueID) %>%
summarize(max_germ = max(grass_germ))
view(max_perrep)
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(temp, min, rep, uniqueID) %>%
summarize(max_germ = max(grass_germ))
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(temp, min, rep, uniqueID) %>%
summarize(max_germ = max(grass_germ)) %>%
ungroup()
view(max_perrep)
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(temp, min, rep, temp.min, uniqueID) %>%
summarize(max_germ = max(grass_germ)) %>%
ungroup()
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(uniqueID) %>%
summarize(max_germ = max(grass_germ)) %>%
ungroup()
view(max_perrep)
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(temp, min, rep, temp.min, uniqueID) %>%
summarize(max_germ = max(grass_germ)) %>%
ungroup()
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(temp, min, rep, temp.min, uniqueID) %>%
summarize(max_germ = max(grass_germ))
mean_pertreat <- max_perrep %>%
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = sd(max_germ)
)
view(mean_pertreat)
mean_pertreat <- max_perrep %>%
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = sd(max_germ),
se = round((sd(max_germ)) / sqrt(length(max_germ)),1)
)
mean_pertreat
view(mean_pertreat)
mean_pertreat <- max_perrep %>%
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = round(sd(max_germ), 2),
se = round((sd(max_germ)) / sqrt(length(max_germ)),1)
)
view(mean_pertreat)
hist(max_perrep$max_germ)
shapiro.test(max_perrep$max_germ) # <- data: not normal
mean_pertreat <- max_perrep %>%
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = round(sd(max_germ), 2),
se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
max = max(max_germ),
min = min(max_germ),
)
view(mean_pertreat)
boxplot(max_perrep$max_germ)
boxplot(max_germ ~ temp.min, max_perrep)
boxplot(max_germ ~ temp, max_perrep)
grassmortality <- grassmortality_load %>%
mutate(date = as.character(date),
temp = as.factor(temp),
min = as.character(min),
rep = as.character(rep),
grass_germ = as.integer(grass_germ)) %>%
mutate(temp.min = paste(temp, min, sep = "C.")) %>%
mutate(uniqueID = paste(temp.min, rep, sep = ".rep"))
grassmortality <- grassmortality_load %>%
mutate(date = as.character(date),
temp = as.factor(temp),
min = as.character(min),
rep = as.character(rep),
grass_germ = as.integer(grass_germ)) %>%
mutate(temp.min = paste(temp, min, sep = "C.")) %>%
mutate(uniqueID = paste(temp.min, rep, sep = ".rep")) %>%
mutate(temp = factor(temp, levels = c(20, 50, 100, 150, 200, 250)))  # Reorder
hist(max_perrep$max_germ)
shapiro.test(max_perrep$max_germ) # <- data: not normal
boxplot(max_germ ~ temp, max_perrep)
# view data
plot(grass_germ ~ date, grassmortality)
max_perrep <- grassmortality %>%
dplyr::select(temp, min, rep, temp.min, uniqueID, grass_germ) %>%
group_by(temp, min, rep, temp.min, uniqueID) %>%
summarize(max_germ = max(grass_germ))
mean_pertreat <- max_perrep %>%
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = round(sd(max_germ), 2),
se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
max = max(max_germ),
min = min(max_germ),
)
hist(max_perrep$max_germ)
shapiro.test(max_perrep$max_germ) # <- data: not normal
boxplot(max_germ ~ temp, max_perrep)
mean_pertreat <- max_perrep %>%
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = round(sd(max_germ), 2),
se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
max = max(max_germ),
min = min(max_germ),
lower_quartile = quantile(max_germ, 0.25),  # 25th percentile
upper_quartile = quantile(max_germ, 0.75)   # 75th percentile
)
view(mean_pertreat)
pairwise.wilcox.test(max_perrep$max_germ, max_perrep$temp, p.adjust.method = "BH")
mean_pertreat
view(mean_pertreat)
install.packages("openxlsx")
write.xlsx(mean_pertreat, file = "grassmortality_stats_2024dec16.xlsx")
library(openxlsx)
write.xlsx(mean_pertreat, file = "grassmortality_stats_2024dec16.xlsx")
mean_pertreat <- max_perrep %>%
filter(min == "2")
mean_pertreat
mean_pertreat <- max_perrep %>%
filter(min == "2") %>%
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = round(sd(max_germ), 2),
se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
max = max(max_germ),
min = min(max_germ),
lower_quartile = quantile(max_germ, 0.25),  # 25th percentile
upper_quartile = quantile(max_germ, 0.75)   # 75th percentile
)
mean_pertreat
hist(max_perrep$max_germ)
shapiro.test(max_perrep$max_germ) # <- data: not normal
boxplot(max_germ ~ temp, max_perrep)
kruskal.test(max_germ ~ temp, data = max_perrep)
pairwise.wilcox.test(max_perrep$max_germ, max_perrep$temp, p.adjust.method = "BH")
mean_pertreat
mean_pertreat <- max_perrep %>%
filter(min == "5") %>% # select only 2 min duration for Ch1 Stand Deg Suppl. Table
group_by(temp.min) %>%
summarize(n = length(max_germ),
mean_germ = mean(max_germ),
sd = round(sd(max_germ), 2),
se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
max = max(max_germ),
min = min(max_germ),
lower_quartile = quantile(max_germ, 0.25),  # 25th percentile
upper_quartile = quantile(max_germ, 0.75)   # 75th percentile
)
mean_pertreat
mean_pertreat <- max_perrep %>%
filter(min == "5") %>% # select only 2 min duration for Ch1 Stand Deg Suppl. Table
group_by(temp.min) %>%
summarize(n = length(max_germ),
#mean_germ = mean(max_germ),
#sd = round(sd(max_germ), 2),
#se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
max = max(max_germ),
min = min(max_germ),
lower_quartile = quantile(max_germ, 0.25),  # 25th percentile
upper_quartile = quantile(max_germ, 0.75)   # 75th percentile
)
mean_pertreat
mean_pertreat <- max_perrep %>%
filter(min == "5") %>% # select only 2 min duration for Ch1 Stand Deg Suppl. Table
group_by(temp.min) %>%
summarize(#n = length(max_germ),
#mean_germ = mean(max_germ),
#sd = round(sd(max_germ), 2),
#se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
#max = max(max_germ),
#min = min(max_germ),
lower_quartile = quantile(max_germ, 0.25),  # 25th percentile
upper_quartile = quantile(max_germ, 0.75)   # 75th percentile
)
mean_pertreat
mean_pertreat <- max_perrep %>%
filter(min == "5") %>% # select only 2 min duration for Ch1 Stand Deg Suppl. Table
group_by(temp, temp.min) %>%
mutate(temp = factor(temp, levels = c(20, 50, 100, 150, 200, 250))) %>%  # Reorder
summarize(#n = length(max_germ),
#mean_germ = mean(max_germ),
#sd = round(sd(max_germ), 2),
#se = round((sd(max_germ)) / sqrt(length(max_germ)),1),
median_germ = median(max_germ),
#max = max(max_germ),
#min = min(max_germ),
lower_quartile = quantile(max_germ, 0.25),  # 25th percentile
upper_quartile = quantile(max_germ, 0.75)   # 75th percentile
)
mean_pertreat
